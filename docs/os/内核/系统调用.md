# 系统调用

system call

全称应该为操作系统功能调用，内核的接口，是操作系统开放给开发者的接口，使得开发者在编程可以调用操作系统的功能。

通过系统调用，可以使处理器的状态由用户态变为内核态。

公用函数库构建在系统调用之上，应用程序即可以公用函数库，也可以使用系统调用。

本质上，系统调用主要就是执行若干个内核函数。


![系统调用](/asset/img/系统调用.png)


### 区分

- 内核函数
    
    操作系统内核提供的函数程序。

- 系统调用

    实际上，系统调用主要就是执行若干个内核函数。

- 函数库

    一些功能函数，函数库中的函数内部可以调用系统调用，用来封装成更方便高级的函数。

- 应用程序

    可以调用函数库，也可以直接调用系统调用。


### 调用机制

1. 中断/异常机制


2. 选择一条特殊指令：陷入指令

> 陷入指令
>
> 又称为访管指令。处理器执行到陷入指令时，就会产生一个中断或异常，通过中断处理程序（这里就是系统调用总程序，在系统调用总程序中，查找具体的系统调用处理程序），将用户态切换到内核态。

所有的系统调用都是通过陷入指令进入内核状态的。


3. 系统调用编号和参数

    为每个系统调用设置编号


4. 系统调用表

    每个系统调用都有一段内核函数，系统调用表记录每个系统调用对应的代码入口地址。
