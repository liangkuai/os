# 死锁

死锁是指两个或两个以上的进程在执行过程中，因争夺资源而造成的一种互相等待的现象，若无外力作用，它们都将无法推进下去。


### 死锁的四个必要条件

#### 1. 互斥条件

某个资源在任一时刻只能由一个进程占用，无法被多个进程共享。

#### 2. 不可剥夺条件

进程所获得的资源在未使用完毕之前，其他资源申请者不能强行地从资源占有者手中夺取资源，而只能由占有该资源的进程自行释放。

#### 3. 请求和保持条件

一个进程因请求其他资源而阻塞时，对已获得的资源保持不放。

#### 4. 循环等待条件

一系列进程互相持有其他进程所需要的资源。

存在一个进程等待序列 {P1, P2, ..., Pn}，其中 P1 等待 P2 所占有的某一资源，P2 等待 P3 所占有的某一资源，......，而 Pn 等待 P1 所占有的的某一资源，形成一个进程循环等待环。



## 死锁处理

- 不允许死锁发生
    - 预防死锁（静态策略）
    - 避免死锁（动态策略）
- 允许死锁发生
    - 检测和接触死锁


### 预防死锁

> 破坏死锁产生的4个必要条件

在系统运行之前就采取措施，也就是在系统设计时确定资源分配算法，消除发生死锁的任何可能性。虽然这种方法比较保守、资源利用率低，但简单明了并且安全可靠，仍被广泛采用。这是一种预先的静态策略。

产生死锁的四个必要条件中，互斥条件和不可剥夺条件由共享资源本身的使用特性所决定的，因此不好破坏，相反还应加以保证，实用的死锁预防办法就是通过破坏产生死锁的请求和保持条件、循环等待条件。


### 避免死锁

- [ ] 银行家算法


### 检测和解除死锁

#### 1. 检测死锁

- [ ] 数据结构：资源分配图
- [ ] 死锁检测算法

> 死锁定理：如果某个时刻系统的资源分配图是不可简化的，那么此时系统死锁。

#### 2. 解除死锁

- 资源剥夺法
- 撤销进程法
- 进程回退法



---

### 参考

- [2.4 死锁 - 王道考研 操作系统 - bilibili](https://www.bilibili.com/video/BV1YE411D7nH?p=29)
- [操作系统——死锁的概念以及死锁处理策略](https://www.cnblogs.com/wkfvawl/p/11598647.html)
